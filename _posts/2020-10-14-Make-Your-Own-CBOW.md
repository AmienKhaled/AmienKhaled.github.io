---
title: "ูุง ูู ุงู Word Embeddings ุ ููุงูู ุทุฑููุฉ ุงู CBOW ุ ูููููุฉ ุชุทุจูููุง ุนูู ุงููุบุฉ ุงูุนุฑุจูุฉ ุ"
tagline: "ูู ูุฐุง ุงูููุงู ุณูุชุนุฑู ุฃูุซุฑ ุนูู ุทุฑููุฉ CBOW ูุตูุงุนุฉ Word Embeddings ูุชุทุจูููุง ุนูู ุงููุบุฉ ุงูุนุฑุจูุฉ"
excerpt: "ูู ูุฐุง ุงูููุงู ุณูุชุนุฑู ุฃูุซุฑ ุนูู ุทุฑููุฉ CBOW ูุตูุงุนุฉ Word Embeddings ูุชุทุจูููุง ุนูู ุงููุบุฉ ุงูุนุฑุจูุฉ"
header:
  overlay_image: images/2020-10-14-Make-Your-Own-CBOW/headers2.jpg
  teaser: images/2020-10-09-Make-Your-Own-CBOW/headers2.jpg
categories:
  - Blog
tags:
    - Word2vec
    - NLP
    - Python
    - CBOW
toc: true
toc_sticky: true
---
<style>
.wrapper, .toc__menu, table, .ara{
  direction: rtl;
}
p {
  text-align: justify;
  text-justify: inter-word;
}
</style>
 
 
## ููุฏูุฉ
{: .text-right}
 
<p dir='rtl'>
ูู ูุฐุง ุงูููุงู ุณูุชุนุฑู ุณููุง ุนูู ููุถูุน ููู ูู ุนูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉ (NLP) ููู Word embeddings ูููููุฉ ุชุทุจููุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงู CBOW  ูุงูุชู ุณูุจุฑูุฌูุง ูุนุง ูู ุงูุตูุฑ ุจุงุณุชุฎุฏุงู  ูุบุฉ ุงูุจุฑูุฌุฉ ุจุงูุซูู (Python)
</p>
 
 
## ุจุนุถ ุงููุชุทูุจุงุช ุงููุณุจูุฉ
{: .text-right}

<p dir='rtl'>
ูุจู ุงู ูุจุฏุง ูุนุงู ูุฌุจ ุงู ูุนุฑุถ ุจุนุถ ุงููุชุทูุจุงุช ุงููุณุจูุฉ ูููู ุงูููุงู ุจุดูู ุณูู ูุณูุณู
</p>
 
- **Python**
- **Deep Learning**
- **Gradient descent**
 
## ุชุฑุฌูุฉ ุจุนุถ ุงููุตุทูุญุงุช ุงูุนูููุฉ
{: .text-right}

<p dir='rtl'>
ุฎูุงู ูุฐุง ุงูููุงู ุณูู ูุณุชุฎุฏู ุงููุตุทูุญุงุช ุงูุนูููุฉ ุจูุบุชูุง ุงูุงุตููุฉ ุญูุซ ุงู ุชุฑุฌูุชูุง ุณูุถุน ุจุนุถ ุงูุบููุถ ู ุณูุตุนุจ ุนููู ุงูุจุญุซ ูุงูุชุนูู ูู ูุฐุง ุงูููุถูุน ูููุง ุจุนุฏ ูุฐูู ุณุฃูุชุจูุง ููุง ูู ูุณุฃุถุน ููุง ุจุนุถ ุงูุชุฑุฌูุงุช ุงูุชู ูููู ุงูุนุซูุฑ ุนูููุง
</p>
 
- **Vector** : ููุชุฌู
- **Word2Vec** : ุชูุซูู ุงููููุงุช ูููุชุฌูุงุช
- **Continuous Bag of words (CBOW)** : ูุงุญุฏุฉ ูู ุงูุทุฑู ุงููุณุชุฎุฏูุฉ ูุชูุซูู ุงููููุงุช ููุชุฌูุงุช
- **Natural language processing (NLP)** : ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉ
- **Gradient descent** : ูู ุงูุฎูุงุฑุฒููุฉ ุงููุณุชุฎุฏูุฉ ูุชุญุณูู ุงูุฎุทุฃ ุงููุงุชุฌ ูู ุงูุชุนูู ูุฏุฑ ุงูุฅููุงู
- **Deep Learning** : ุงูุชุนูู ุงูุนูููุ ููู ูุฑุน ูู ูุฑูุน ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
- **Integers**: ุนุฏุฏ ุตุญูุญ
 
## ูุดููุฉ ุชูุซูู ุงููููุงุช
{: .text-right}

<p dir='rtl'>
ูู ุงู <strong>Deep learning</strong> ูุฌุจ ุฃู ุชููู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูุชุนูู ุนูู ููุฆุฉ ุฃุฑูุงู ุูุนูู ุณุจูู ุงุฐุง ุงุฑุฏุช ุจูุงุก model ููุชุนุฑู ุนูู ูุฏู ุฑุถุง ุงูุนููุงุก ุนู ุฎุฏูุฉ ูุนููุฉ ูู ุฎูุงู ุชุนูููุงุชููุ ูุณุชุญุชุงุฌ ุจูุง ุดู ูุจูุงูุงุช  ููููุฉ ูู ูููุงุช (ูุตูุต ุงูุชุนูููุงุช ุงูููุชูุจ ุจูุงุณุทุฉ ุงูุนููุงุก) ุ ูููู ุชุจุฏุฃ ุนูููุฉ ุงูุชุนูู ูุนููู ุชุญููู ุชูู ุงููุตูุต ูุฃุฑูุงู ุญุชู ูุณุชุทูุน ุงู model ุงูุชุนุงูู ูุนูุงุ ูููุง ุณูุธูุฑ ุณุคุงู ููู ูููู ุชูุซูู ุงููุตูุต ูุฃุฑูุงูุ
</p>

## ุงูุทุฑู ุงููุฎุชููุฉ ูุชูุซูู ุงููุตูุต ุงูู ุงุฑูุงู
{: .text-right}

<p dir='rtl'>
ููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ูุชุญููู ุงููุตูุต ุณูุนุฑุถ ููุง ุจุถ ูููุง ุ ูุณูุทุจู ูู ุงูููุงูุฉ ุจุทุฑููุฉ ุงู CBOW
</p>

## Integers
{: .text-right}
<p dir='rtl'>
ูู ูุฐู ุงูุทุฑููุฉ ูุณุชุฎุฑุฌ ุงููููุงุช ูู ุงููุตูุต ุงููุชูุงูุฑุฉ ูุฏููุง ุจุฏูู ุชูุฑุงุฑุูุจุนุฏ ุฐูู ูุถุน ููุง ุฑูู ุตุญูุญ ูููุฒ ููุง . ุนูู ุณุจูู ุงููุซุงู ููุชุฎูู ุฃู ุงููุตูุต ุงูุชุงููุฉ ูู ุงูุจูุงูุงุช ูุงููุทููุจ ุชูุซูููุง ุจุทุฑููุฉ ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ
</p>

<div dir='rtl' class='notice--success'>
1-   ุฃูุง ุฃุญุจ ุชุนูู ุงูุจุฑูุฌุฉ
<br>
2- ุงูุจุฑูุฌุฉ ุชูุชุญ ุฃูู ุฌุฏูุฏุฉ ููุนุงูู
<br>
3- ุฃูุง ุฃุญุจ ุชุทููุฑ ุชุทุจููุงุช ุฌุฏูุฏุฉ
<br>
<br>
</div>

<p dir='rtl'>
ุงููููุงุช ุงูููุฌูุฏุฉ ูู ุงููุซุงู ุจุฏูู ุชูุฑุงุฑ :
</p>

<div dir='rtl' class='notice--success'>
ุฃูุง-ุฃุญุจ-ุชุนูู-ุงูุจุฑูุฌุฉ-ุชูุชุญ-ุฃูู-ุฌุฏูุฏุฉ-ููุนุงูู-ุชุทููุฑ-ุชุทุจููุงุช   
</div>

| ุงููููุฉ      | ุงูุฑูู |
| ----------- | ----------- |
| ุฃูุง      | 1       |
| ุฃุญุจ   | 2        |
| ุชุนูู   | 3        |
| ุงูุจุฑูุฌุฉ   | 4        |
| ุชูุชุญ   | 5        |
| ุฃูู   | 6        |
| ุฌุฏูุฏุฉ   | 7        |
| ููุนุงูู   | 8        |
| ุชุทููุฑ   | 9        |
| ุชุทุจููุงุช   | 10        |

<p dir='rtl'>
ูุฏ ุชููู ูุฐู ุงูุทุฑููุฉ ุญูุช ูุดููุฉ ุชูุซูู ุงูุจูุงูุงุช ูููู ุชุธู ููุงู ูุดููุฉ ุญููููุฉ ูู ุฃู ุงูุฃุฑูุงู   ุงูุชู ุชูุซู ุงููููุงุช ูุง ุชุญูู ุฃู ูุนููุ ููููู ุชุจุฏูู ุงูุงุฑูู ุงูููุงุจูุฉ ููููุงุช ุจุงู ุฑูู ุงุฎุฑ ุููุซุงู ูููู ุงูุชุจุฏูู ุจูู ูููุชูู (ุฃูุง:1 ุ ุชุนูู:3) ูู ุงูุฌุฏูู ุจุงูุฃุนูู ูุชุตุจุญ (ุงูุง :3 ุ ุชุนูู:1)
</p>


## One-hot Vectors
{: .text-right}
<p dir='rtl'>
ููุฐู ุงูุทุฑููุฉ ุชุงุฎุฏ ูู ูููุฉ ุฑูู ุฎุงุต ุจูุง ุ ูููู ููุง ูุชู ุชูุซูู ุงููููุฉ ูู ุฎูุงู ูุชุฌู (Vector)  ุฌููุน ุนูุงุตุฑู ูููุง ุตูุฑ ูุง ุนุฏุง ุงูุนูุตุฑ ูู ุงูููุงู ุงููุงุจู ูุฑูู ุงููููุฉ ููููู ูููุชู ุจุตูุฑ ุ ุดูู ูุฐุง ุงููุชุฌู $$M*1$$ ุญูุซ M ุนุฏุฏ ุงููููุงุช ูู ุงููุต ุจุฏูู ุชูุฑุงุฑ. ููููู ุงูุงูุฑ ุงูุถุญ ุฏุนููุง ูุทุจู ุนูู ุงููุซุงู ุจุงูุงุนูู ุชูู ุงูุทุฑููุฉ
</p>

<div dir='rtl' class='notice--success'>
ูู ุงููุซุงู ุจุงูุฃุนูู ูููุฉ "ุฃูู" ุชุญูู ุงูุฑูู 6 ุููุงุญุธ ููุง ุฃู ุงููุชุฌู ุงูุฎุงุต ุจูููุฉ "ุฃูู" ุฌููุน ุนูุงุตุฑู ูููุชูุง ุตูุฑ ูุงุนุงุฏ ุงูุนูุตุฑ ุฑูู 6 ุููุงุญุธ ุงูุถุง ุงู ูุฐุง ุงููุชุฌู ุฎุงุต ููุท ุจูุฐู ุงููููุฉ
</div>

|        | ุฃูู |
| ----------- | ----------- |
| 1      | 0       |
| 2   | 0        |
| 3   | 0        |
| 4   | 0        |
| 5   | 0        |
| 6   | 1        |
| 7   | 0        |
| 8   | 0        |
| 9   | 0        |
| 10   | 0        |

<p dir='rtl'>
ูููุฒุงุช ุชูู ุงูุทุฑููุฉ
</p>
- ุจุณูุทุฉ ูุง ุชุญูู ุชุนููุฏ ูุจุฑูุฌุชูุง
{: .ara}
<p dir='rtl'>
ุนููุจ ุชูู ุงูุทุฑููุฉ
</p>
- ุญุฌู ุงููุชุฌูุงุช ูููู ุฃู ูููู ุถุฎู ูุชุฎูู ูุซูุง ุนุฏุฏ ุงููููุงุช 12M
{: .ara}
- ุงููุชุฌูุงุช ูู ูุฐุฉ ุงูุญุงูู ูุงุชุญูู ุงูุถุง ูุนูู ุฎุงุต ูููููุฉ ูุนุจุฑ ุนููุง
{: .ara}


## Word Embeddings
{: .text-right}
<p dir='rtl'>
ูุชุจุณูุท ูุฐุง ุงูููููู ุ ุชุฎูู ุงู ููุงู ุฎุท ูุฒูุฏ ููู ุงููุนูู ุงูุงูุฌุงุจู ูููุง ุงุชุฌููุง ููููุงุ ููุฒูุฏ ููู ุงููุนูู ุงูุณูุจู ูููุง ุงุชุฌููุง ูููุณุงุฑ ููุง ูู ููุถุญ ุจุงูุงุณูู . ูุจูุฐู ุงูุทุฑููุฉ  ูููููุง ุชูุซูู ุงููููุฉ ูู ุฎูุงู ูุชุฌู ุฐุงุช ุจุนุฏ ูุงุญุฏ 1*1 ูุนุจุฑ ุนู ูุฏู ุฅูุฌุงุจูุฉ ุงู ุณูุจูุฉ ุงููููุฉ ูุนูู ุณุจูู ุงููุซุงู ุฅุฐุง ุงุฎุชุฑูุง ุฑูู ุนุดูุงุฆู (ูุซูุงู 3) ูุจุงูุชุฃููุฏ ุณูููู ูุฐุง ุงูุฑูู ุชูุซูู ููููุฉ ุฅูุฌุงุจูุฉ ูุนูู ุงูุนูุณ ุฅุฐุง ุงุฎุชุฑูุง ุฑูู ุฃูู ูู ุงูุตูุฑ.
</p>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/words_line.png)

<p dir='rtl'>
ุจููุณ ุงูุทุฑููุฉ ุชุฎูู ุฃู ููุงู ุจุฏู ุงูุฎุทุ ูุญูุฑูู ูุญูุฑ ุฑุฃุณู ูุญูุฑ ุฃููู ููุง ูู ููุถุญ ุจุงูุงุณููุุจุญูุซ ุชููู ุงููููุฉ ุชุนุจุฑ ุนู ุดุฆ ูุงุฏู ูููุง ุงุชุฌููุง ูุงุนููุ ู ุชุนุจุฑ ุงููููุฉ ุนู ุดุฆ ุงูุซุฑ ูุนูููุฉ ูููุง ุงุชุฌููุง ูุฃุณูู. ูููููุง ุงูุชุนุจูุฑ ุนู ุงููููุฉ ูู ูุฐู ุงูุญุงูุฉ ุจูุชุฌู ุจุดูู 2*1 ุ ููุซุงู ูููู ุชูุซูู ูููุฉ ููุจ ุจุงููุชุฌู [1.09, 0.57] . ูู ูุฐู ุงูุญุงูุฉ ุฃุตุจุญ ุงููุชุฌู ูุนุจุฑ ุจุดูู ุฃูุจุฑ ุนู ุงููููุฉ ุ ููููุง ุฒุงุฏุช ูููุฉ ุงููุญูุฑ ุงูุฃููู ูููุง ุฒุงุฏุช ุงูููู ุงูุฅูุฌุงุจู ูููููุฉ ุููููุง ุฒุงุฏุช ูููุฉ ุงููุญูุฑ ุงูุฑุฃุณู ุฃุตุจุญุช ุงููููุฉ ุฃูุซุฑ ูุงุฏูุฉุ ูููุฐุง ูู ุจุงูู ุงูุงุชุฌุงูุงุช. ูุจุฐูู ุฃุตุจุญ ุงูุชูุซูู ูุนุจุฑ ุจููุฉ ุงูุซุฑ ุนู ุงููููุฉ. ููููุง ุฒุงุฏุช ุงููุญุงูุฑ ุงู ููุง ูุณูููุง ุงูุงุจุนุงุฏ ุงูุชู ุชูุซู ุงููููุฉ ูููุง ุงุตุจุญ ูุฐุง ุงูุชูุซูู ูุนุจุฑ ุจููุฉ ุงูุซุฑ ุนู ุงููููุฉ.
</p>


![words line](/images/2020-10-14-Make-Your-Own-CBOW/words_2axis.png)

<p dir='rtl'>
ูููุฒุงุช ุชูู ุงูุทุฑููุฉ
</p>

- ุฃุตุจุญุช ุงููุชุฌูุงุช ูู ูุฐุฉ ุงูุทุฑููุฉ ุญุฌููุง ุงูู ูุนุงุฏุฉ ุชููู ุจูู 100~1000 ูููู ูู ุงูุทุฑููุฉ ุงูุณุงุจูุฉ ุฑุจูุง ุชุชุฌุงูุฒ ุงูููููู
{: .ara}

- ุฃุตุจุญ ุงููุชุฌู ูุญูู ูุนูู ููู ูููุฉ
  -  ุฃู ุงููุณุงูุฉ ุจูู ุงููููุงุช ุงููุฑูุจุฉ ูู ุงููุนูู ุงูุตุฑ
    - ูุซุงู : ูุชุฌู ูููุฉ "ุดุฌุฑุฉ" ุชูุฑูุจุง ูุณุงูู ุงููุชุฌู ุงูููุซู ููููุฉ "ุฃุดุฌุงุฑ" ููุฎุชูู ุชูุงูุงู ุนู ุงููุชุฌู ุงูููุซู ููููุฉ "ุชุฐูุฑุฉ"
{: .ara}
  - ุชุณุชุทูุน ุงุณุชุฎุฑุงุฌ ุงูุชุดุงุจู ุงูุฌุฒุฆู ุจูู ุงููููุงุช
    - ูุซุงู: ูููุฉ "ุจุงุฑูุณ" ุจุงููุณุจุฉ ููููุฉ "ูุฑูุณุง"  ูุซู ูููุฉ "ุงููุงูุฑุฉ ุจุงููุณุจุฉ ููููุฉ ุ ูุงุฐุง ููุง ููุชูู Word Embeddings ุตุญูุญุฉ ูุณูููู ุงููุงุชุฌ ูููุฉ "ูุตุฑ"
{: .ara}

<p dir='rtl'>
ูุงูุงู ุจุนุฏ ุงู ุชุนุฑููุง ุนูู ุงูููุฑุฉ ุงูุงุณุงุณูุฉ ุงูุชู ุชุนุชูุฏ ุนูููุง ุงู word embeddings
ููู ูููููุง ุญุณุงุจูุง ุ ูุจุงูุทุจุน ูู ูุฑุณู ูุญุงูุฑ ููุถุน ูู ูููุฉ ุนูู ุชูู ุงููุญุงูุฑ ุ ูููุง ูุงุชู ุฏูู ุงูDeep learning ุ ุณูุชุนุฑู ูู ุงูููุฑุงุช ุงููุงุฏูุฉ ุนูู ุงูุดูุฑ ุงูุทุฑู ุงููุณุชุฎุฏูุฉ ูุญุณุงุจ ุชูู ุงููุชุฌูุงุช
</p>

## ุงูุทุฑู ุงููุฎุชููุฉ ููุญุตูู ุนูู ุงู Word Embeddings
{: .text-right}
<p dir='rtl'>
ูุงูุงู ุจุนุฏ ุงู ุชุนุฑููุง ุนูู ุงูููุฑุฉ ุงูุงุณุงุณูุฉ ุงูุชู ุชุนุชูุฏ ุนูููุง ุงู word embeddings
ููู ูููููุง ุญุณุงุจูุง ุ ูุจุงูุทุจุน ูู ูุฑุณู ูุญุงูุฑ ููุถุน ูู ูููุฉ ุนูู ุชูู ุงููุญุงูุฑ ุ ูููุง ูุงุชู ุฏูู ุงูDeep learning ุ ุณูุชุนุฑู ูู ุงูููุฑุงุช ุงููุงุฏูุฉ ุนูู ุงูุดูุฑ ุงูุทุฑู ุงููุณุชุฎุฏูุฉ ูุญุณุงุจ ุชูู ุงููุชุฌูุงุช
</p>

## ูก- ุทุฑู ุจุณูุทุฉ
{: .text-right}
<p dir='rtl'>
ุงููุดุชุฑู ูู ูุฐู ุงูุทุฑู ุงูุซูุงุซุฉ ุฅู ูู ูููุฉ ููุง ูุชุฌู ูุงุญุฏ ููุท ุจุบุถ ุงููุธุฑ ุนู ูููุน ุงููููุฉ ูู ุงูุฌููุฉ (ูุซุงู: ุฑุฃูุช ุนูู ูุง)   
</p>

<div dir='rtl' class='notice--success'>
ูก- ุฑุฃูุช ุนูู ูุงุก ูู ุงูุตุญุฑุงุก
<br>
ูข- ููุฌุฏ ููุฐุจุงุจุฉ ุฃูุซุฑ ูู ุนูู
<br>
</div>

<p dir='rtl'>
ูุนูู ูููุฉ "ุนูู" ูู ุงูุฌููุฉ ุงูุงููู ุชุฎุชูู ุนู ูุนูู "ุนูู" ูู ุงูุฌููุฉ ุงูุซุงููุฉ ูููู ูููุง ููุณ ูููุฉ ุงููุชุฌู  
</p>

- Word2Vec (Google, 2013)
  - Continuous bag-of-word (CBOW)
  - Continuous Skip-gram/Skip-gram with negative sampling (SGNS)

- Global Vectors (GLoVe) (Stanford, 2014)

- fastText (Facebook, 2016)
  - ุงููููุฒ ูู ูุฐุฉ ุงูุทุฑููุฉ ุงููุง ุชุณุชุทูุน ุญุณุงุจ ูุชุฌูุงุช ููููุงุช ูู ุชุฑุงูุง ูู ูุจู ูุฃููุง ุชุนูู ุนูู ุงูุญุฑูู ุจุฏูุงู ุนู ุงููููุงุช


## ูข- ุทุฑู ุฃูุซุฑ ุชุนููุฏุงู
{: .text-right}
<p dir='rtl'>
ุงููุดุชุฑู ูู ูุฐู ุงูุทุฑู ุงูุซูุงุซุฉ ุฃู ุญุณุงุจ ุงููุชุฌู ูููููุฉ ูุชุบูุฑ ุจุญุณุจ ูุนูุงูุง ูู ุงูุฌููุฉุ ูุฅุฐุง ุทุจููุง ุนูู ุงูุซุงู ุงูุณุงุจู ุ ุณูุตุจุญ ููููุฉ "ุนูู" ูู ุงูุฌููุชูู ูุชุฌููู ูุฎุชูููู
</p>

- BERT (Goole, 2018)
- ELMo (Allen Institute for AI, 2018)
- GPT-2 (OpenAI, 2018)

## ูุง ูู ุทุฑููุฉ ุงู CBOW
{: .ara}
{: .text-right}
<p dir='rtl'>
CBOW ูู ุทุฑููุฉ ูุณุชุทูุน ุจูุง ุญุณุงุจ ุงูู Word emmbeddings ุ ูุชุนุชูุฏ ูุฐู ุงูุทุฑููุฉ ุนูู  ุชุฏุฑูุจ model ููุชูุจุค ุจุงููููุฉ ูู ูุฌููุนุฉ ุงููููุงุช ุงููุญูุทุฉ ุจุชูู ุงููููุฉ. ูุซุงู :
</p>

<div dir='rtl' class='notice--success'>
ุฑุฃูุช ุงูููู __ุ__ ุตุบูุฑ ููุจุญ.
</div>

<p dir='rtl'>
ุงููููุงุช ุงููุชุงุญุฉ ูู model ููุชูุจุค :
</p>

<div dir='rtl' class='notice--success'>
[ููุจ - ูุทุฉ - ูุฑูุฉ - ููุนุจ]
</div>
<p dir='rtl'>
ููุฌุจ ุฃู ูุฎุชุงุฑ ุงู model ููุง ูููุฉ ููุจ
</p>

## ููููุฉ ุชุญุถูุฑ ุงูุฃูุซูุฉ ูุงู dataset
{: .ara}
{: .text-right}
<p dir='rtl'>
ูุจู ุงูุจุฏุก ูู ุดุฑุญ ูุฐุง ุจุงูุชูุตูู ุ ููุงู ุจุนุถ ุงูููุงููู ุงูุชู ูุฌุจ ูุนุฑูุชูุง
</p>

<p dir='rtl'>
ุชุณูู ุงููููุฉ ุงููุฑุงุฏ ุงูุชูุจุค ุจูุง ุจ (center word)ุ ูุชุณูู ุงููููุงุช ุงููุญูุทุฉ ุจุงููููุฉ ูู ุงููููู ู ุงููุณุงุฑ ุจุงู (Context Word) ุ ุนุฏุฏ ุงููููุงุช ุงููุณุชุฎุฏู ุนูู  ุฃู ุฌุงูุจ ูู ุจุงู (context half-size)ุ ููุฑูุฒ ููุง ุจุงูุฑูุฒ (C) ุ ููุทูู ุนูู ูุฌููุน (Context word + center word) ุจุงู (windows) ููุชู ุญุณุงุจู ุจุงุณุชุฎุฏุงู ูุฐุฉ ุงููุนุงุฏูุฉ $$2*c + 1$$
ูุซุงู :
</p>

<div dir='rtl' class='notice--success'>
ููุง ูู ููุถุญ ุจุงูุตูุฑุฉ ุงู (context half-size) ูุณุงูู 2ุ ูุญุณุงุจ ุงูู (windows size)ุ ูุณุชุฎุฏู ุงููุนุงุฏูุฉ  ุจุงูุงุนูู   
$$window size=2*5+1=5$$
</div>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/cbow_ele.png)


## ุดูู ุงู Dataset
{: .ara}
{: .text-right}
<p dir='rtl'>
ููุณุชุทูุน ุชุทุจูู ุทุฑููุฉ ุงู CBOW ูุฌุจ ุฃู ุชููู ุงููุตูุต ุจุดูู ูุนููุ ููู ุฃู ุชููู ุงู (Context words) ูู ุงููุฏุฎูุงุช ูู Model ูุชููู ุงู ุงููุฎุฑุฌุงุช ุงู ุงู labels ูู ุงู (Ccenter word) ุ ููููุชุฑุถ ุฃู ุงููุตูุต   ุจุงูุงุณูู ุณูุณุชุฎุฏููุง ูู ุนูููุฉ ุงูุชุฏุฑูุจุ ู ุณูุณุชุฎุฏู (context half-size) ูุณุงูู 1
</p>

<div dir='rtl' class='notice--success'>
ุงููุฑุงุกุฉ ุนูููุฉ ูุนุฑููุฉ ุชุณุชูุฏ ุนูู ุชูููู ุฑููุฒ ุชุณูู ุญุฑููุง ูุชูููู ูุนููุ ูุงููุตูู ุฅูู ูุฑุญูุฉ ุงูููู ูุงูุฅุฏุฑุงู.
</div>


<p dir='rtl'>
ูุณุชููู ุงู Dataset ุจูุฐุง ุงูุดูู ุจุงูุงุณูู ุ ุญูุซ ุณูุฑูุฒ ูููุฏุฎูุงุช ุจุงูุฑูุฒ X  ูุงููุฎุฑุฌุงุช ุจุงูุฑูุฒ Y
</p>



| X      | Y |
| ----------- | ----------- |
| ุงููุฑุงุกุฉ ูุนุฑููุฉ      | ุนูููุฉ       |
| ุนูููุฉ ุชุณุชูุฏ   | ูุนุฑููุฉ        |
| ูุนุฑููุฉ ุนูู   | ุชุณุชูุฏ        |
| ุชุณุชูุฏ ุชูููู   | ุนูู        |
| ุนูู ุฑููุฒ   | ุชูููู        |
| ุชูููู ุชุณูู   | ุฑููุฒ        |
| ุฑููุฒ ุญุฑููุง   | ุชุณูู        |
| ุชุณูู ูุชูููู   | ุญุฑููุง        |
| ุญุฑููุง ูุนูู   | ูุชูููู        |
| ูุชูููู ูุงููุตูู   | ูุนูู        |
| ูุนูู ุฅุงูู   | ูุงููุตูู        |
| ูุงููุตูู ูุฑุญูุฉ   | ุฅุงูู        |
| ุฅูู ุงูููู   | ูุฑุญูุฉ        |
| ูุฑุญูุฉ ูุงูุฅุฏุฑุงู   | ุงูููู        |
| ุงูููู  .   | ูุงูุฅุฏุฑุงู        |


<p dir='rtl'>
ูุงูุขู ุจุนุฏ ุงู ุนุฑููุง ูุง ูู ุงูุดูู ุงูููุชุฑุถ ูู Dataset ุ ููุงู ุงุณุฆูุฉ ุญูู ููููุฉ ุชุญููู ุชูู ุงููุตูุต ูุฃุฑูุงู ุ ููุงูู ุงููููู ูุดุจูุฉ ุงูุชุนูู ุงูุนููู ุ ูููููุฉ ุงุณุชุฎุฑุงุฌ ุงู Word Embeddings ? ูููููุฉ ุชูููู ุฌูุฏุชูุง ุ ุ ูู ูุฐุง ุณูุฌูุจ ุนููู ุนูููุง ูู ุงูููุฑุงุช ุงูุชุงููุฉ
</p>


## ูุนุงูุฌุฉ ุงููุตูุต (Data preprocessing)
{: .ara}

<p dir='rtl'>
ุฏุงุฆูุง ูุง ุชุญุชูู ุงูุจูุงูุงุช ุนูู ุงุดูุงุก ูุง ูุฑุบุจ ุจูุง ุ ุงู ุงุดูุงุก ูุฌุจ ุชุนุฏูููุง ูุชูุงุณุจ ุงู modell ุงูุฎุงุต ุจูุง. ูู ุญุงูุฉ ุงููุตูุต ูุฏ ุชุญุชูู ุนูู ุนูุงูุงุช ุชุฑููู ูุซูุง (:,.!? ..etc), ุฃู ูุฏ ุชุญุชูู ุนูู ุฑููุฒ ุชุนุจูุฑูุฉ ูุซู (๐๐๐โค๏ธ), ุฃู ูุงุดุชุงุฌ ูุซูุง (#NLP, #Python), ุฃู ูุฏ ุชุญุชูู ุนูู ุฑูุงุจุท ูุซู (gooogle.com - github.com)
</p>

<p dir='rtl'>
ูุจุงููุณุจุฉ ููุบุฉ ุงูุนุฑุจูุฉ ุจุงูุฅุถุงูุฉ ูููุดุงูู ุงูุณุงุจูุฉ ูุฏ ุชุญุชูู ุนูู ุนูุงูุงุช ุชุดููู ูุซูุง (ุงููุณุฑุฉ ูุงูุณููู ู ุงูุดุฏุฉ ู...), ููุฏ ููุชุจ ุงูุจุนุถ ุงููุงุก ุงูููููุทุฉ ุจุฏูุง ูู ุงููุงุก ุงูุบูุฑ ููููุทุฉ ูุงูุนูุณ ุงู ุงููุงู ุงููุงุฑุณูุฉ ุจุฏูุง ูู ุงููุงู ููุฐุง ุณูุฎูู ุงูุนุฏูุฏ ูู ุงููุดุงูู ูู ุถูููุง ุชูุฑุงุฑ ุงูููุงู ูุซูุง (ุงูุชู - ุงูุชู) ุณุชุตุจุญ ูููุชูู ูุฎุชููุชูู ุจุณุจุจ ุงุฎุชูุงู ุงููุงุก ุจุงูุฎุทุฃ. ู ุงูุญู ุ!
</p>


<p dir='rtl'>
ูุนุชูุฏ ุงูุญู ุนูู ุงูุชุทุจูู ุงูุฐู ุชุนูู ุนูููุ ูุงุงูุฐู ูุฌุจ ุนููู ุงูุงุญุชูุงุธ ุจู ู ูุงูุฐู ูุฌุจ ุนููู ุชุบููุฑู. ูุซูุง ูู ุงูุชุฑุถูุง ุงููุง ูุนูู ู ุงูุดุงุก word embeddings ุฎุงุตุฉ ุจุงูุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญู ุงู ุงู ุชุทุจูู ุณูููู ูููุง ุนูุงูุงุช ุงูุชุดููู ููุฌุจ ุฃู ูุชุฑู ุชูู ุงูุนูุงูุงุช. ุงูุง ุงุฐุง ุงูุชุฑุถ ุฃููุง ูุนูู ุนูู ุชุทุจูู ูุณุชุฎุฏู ูุบุฉ ุนุงููุฉ ููุณุชุทูุน ุฃู ูุฒูู ุนูุงูุงุช ุงูุชุดูููุ  ูุงูุนุงููุฉ ูุง ุชุญุชุงุฌ ุนูุงูุงุช ุชุดููู ุจุตูุฑุฉ ูุจูุฑุฉ. ุงูุถุง ูุฌุจ ุนููู ุงู ุชุนุฑู ูู ุณูููู ูุซูุง ุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ ูุคุซุฑุฉ ูู ุงูุชุทุจูู ุฃู ูุง. ูู ูุฐู ุงูุงููุฑ ูุฌุจ ุงู ุชููู ูู ุฐููู ูุจู ุจุฏุก ุนูููุฉ ูุนุงูุฌุฉ ุงููุต
</p>



<p dir='rtl'>
ูู ูุฐุง ุงูููุงู ุณูุณุชุฎุฏู ููุท ุงูุญุฑูู ุงูุนุฑุจูุฉ ูุงูููุทุฉุ ูุณูุจุณุท ุงูุซุฑ ุงููุบุฉ ุฃู ุณูุฒูู ุนูุงูุงุช ุงูุชุฑูููุ ู ุณูุณุชุจุฏู ุจุนุถ ุงูุญุฑูู ุงูุชู ุณุชุนูู ุนูู ุชูุฑุงุฑ ูููุงุช ุจููุณ ุงููุนูู ูุซูุง (ุฃ-ุฅ-ุข)
</p>


### ูก- ุฅุฒุงูุฉ ุนูุงูุงุช ุงูุชุฑููู
{: .ara}

<p dir='rtl'>
ุณูุณุชุฎุฏู ููุง ููุชุจุฉ re ููู ุงุฎุชุตุงุฑ ู (Regular expression) ููู ูููู ููู ุฌุฏุง ูุฌุจ ุชุนููู ุ ูุฃูู ูุณูู ุงูุนุฏูุฏ ูู ุงูุนูููุงุช ุนูู ุงููุตูุต
</p>

```python
import re

arabic_diacritics = re.compile("""
                             ู    | # Tashdid
                             ู    | # Fatha
                             ู    | # Tanwin Fath
                             ู    | # Damma
                             ู    | # Tanwin Damm
                             ู    | # Kasra
                             ู    | # Tanwin Kasr
                             ู    | # Sukun
                             ู     # Tatwil/Kashida
                         """, re.VERBOSE)

def remove_diacritics(text):
    text = re.sub(arabic_diacritics, '', text)
    return text
```

<p dir='rtl'>
ูุซุงู
</p>

```python
text = 'ูููู ุบูุงุฏูุฑู ุงูุดููุนูุฑูุงุกู ููู ููุชููุฑูุฏูููู'
print(remove_diacritics(text))
```
<p dir='rtl'>
ุงููุชูุฌุฉ
</p>

```python
'ูู ุบุงุฏุฑ ุงูุดุนุฑุงุก ูู ูุชุฑุฏู'
```

### ูข- ุชุจุณูุท ุญุฑูู ุงููุบุฉ
{: .ara}

<p dir='rtl'>
ููุง ุณูุณุชุจุฏู ุงูุญุฑูู ุงูุชู ูููู ูุชุงุจุชูุง ุจุฃูุซุฑ ูู ุดูู ูุงุณุชุจุฏุงููุง ุจุดูู ูุงุญุฏ ููุท ููุชุจุณูุท ูุซู    te (ุฅ-ุฃ-ุข) ุณูุณุชุจุฏูู ุจ [ุง]
</p>

```python
def normalize_arabic(text):
    text = re.sub("[ุฅุฃุขุง]", "ุง", text)
    text = re.sub("ู", "ู", text)
    text = re.sub("ุฉ", "ู", text)
    text = re.sub("ฺฏ", "ู", text)
    text = re.sub("ูุงู", "ู ุงู", text)
    return text
```

<p dir='rtl'>
ูุซุงู
</p>

```python
text = 'ุฃุญุจ ูุนุจ ูุฑุฉ ุงููุฏู ูฺฏุฑุฉ ุงูุณูุฉ'
print(normalize_arabic(text))
```
<p dir='rtl'>
ุงููุชูุฌุฉ
</p>

```python
'ุงุญุจ ูุนุจ ูุฑุฉ ุงููุฏู ููุฑุฉ ุงูุณูุฉ'
```

### ูฃ- ุงููุตูุต ุงููุฎุชูุทุฉ
{: .ara}
<p dir='rtl'>
ุชููู ุงููุตูุต ุงูุนุฑุจูุฉ ุฃุญูุงูุง ุจูุง ุญุฑูู ูุนูุงูุงุช ุชุฑููู ูุงุญูุงูุง ุจูุง ุงุจุฌุฏูุงุช ูู ูุบุงุช ุงุฎุฑู. ูุฐูู ูู ุณูุณุชุฎุฏู ุงูููุชุจุฉ re ููุณุชุฎุฑุฌ ููุท ุงูุญุฑูู ุงูุนุฑุจูุฉ ูุงูููุทุฉ
</p>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/arabic_rep.png)

<p dir='rtl'>
ุงุฐุง ุงุณุชุฎุฏููุง ุงูุฌุฏูู ุจุงูุตูุฑุฉ ููุนุฑู ุงูููุฏ ุงูููุงุจู ููุญุฑูู ุงูุนุฑุจูุฉุ ุณูุฑู ุงููุง ุชูุน ุจูู ุงูุญุฑููู (ุก-ู) ุฃู ุจูู ุงูููุฏ (0621-064A)
</p>

```python
def get_arabic_and_full_stop(text):
    text = re.findall(r'[\u0621-\u064a]+|\.', text)
    return text
```
<p dir='rtl'>
ูุซุงู
</p>

```python
text = 'ุฃุญุจ ููุงุฏุฉ ุงูุณูุงุฑุงุช ูู ููุน BMW M850 .'
print(get_arabic_and_full_stop(text))
```
<p dir='rtl'>
ุงููุชูุฌุฉ
</p>

```python
['ุฃุญุจ', 'ููุงุฏุฉ', 'ุงูุณูุงุฑุงุช', 'ูู', 'ููุน', '.']
```

<p dir='rtl'>
ุณูุถุน ูู ุงููุตูุต ุงูุชู ุนุงูุฌูุงูุง ูู ููุฆุฉ list ุจุญูุซ ูุณูู ุงูุชุนุงูู ูุนูุงุ ูุงุณุชุฎุฑุงุฌ ุงู (center words) ู (context words), ูุชุญููููุง ุฅูู ุงูุดูู ุงููุทููุจ
</p>


### ูค- ููุน ุงููุตูุต ุงููุณุชุฎุฏูุฉ ูู ุงูุชุฏุฑูุจ (Dataset)
{: .ara}

<p dir='rtl'>
ููุงู ุงูุนุฏูุฏ ูู ุงููุตูุต ุงูุชู ูููู ุชุญููููุง ูู ุงูููุงูุน ุงููุฎุชููุฉุ ุงุฎุชุฑุช ูุฐู ุงููุตูุต ูุณูููุฉ ุงูุชุนุงูู ูุนูุง ูุงุณุชุฎุฏุงููุง. ูุนุธู ูุฐู ุงููุตูุต ูู ุฌุฑุงุฆุฏ ูููุงูุงุช. ุฎูุงู ุงูุนูู ูู ูุฐุง ุงููุดุฑูุน ุณูุถุน ุฃู ูุตูุต ูู ุงููุฌูุฏ (data)
</p>

<p dir='rtl'>
ุชูู ูู ุฎุฑูุทุฉ ุงููุฌูุฏุงุช ูู ุงููุฌูุฏ (data) ุจุฏุงุฎู ูู ูุฌูุฏ ููุฌุฏ ุงูุนุฏูุฏ ูู ุงููููุงุช ุงูููุชูุจุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉุ ูุงูุชู ุณูุนุงูุฌูุง ูููุง ุฑุฃููุง ุจุงูุงุนูู ุ ูุชุตุจุญ ุฌุงูุฒุฉ ููุฎุทูุฉ ุงููุงุฏูุฉ
</p>

```
โโโโdata
โ   โโโโarticlesSports
โ   โโโโEchoroukonline
โ   โโโโKhaleej-2004
โ       โโโโEconomy
โ       โโโโInternational news
โ       โโโโLocal News
โ       โโโโSports
```

<p dir='rtl'>
ุจุนุฏ ุงู ุนุฑููุง ููู ุณูุนุงูุฌ ุงููุตูุต ุ ููุถุน ุงูุขู ูู ูุง ุชุนูููุงู ุณุงุจูุงุ ูููุชุญ ุงููููุงุช ููุนุงูุฌ ุงููุตูุต
</p>

```python
data = []
root = '.\\data'
# get all files
files_paths = [ os.path.join(path, name) for path, subdirs, files in os.walk(root) for name in files]

# loop over files and process them, then append them to the data list
for file_path in files_paths:

    f = open(file_path, 'r', encoding='utf-8')

    for line in f :
        text = remove_diacritics(line)
        text = normalize_arabic(text)
        text = get_arabic_and_full_stop(text)
        data += text
    f.close()
```

<p dir='rtl'>
ูุงูุขู ุจุนุฏ ุญูููุง ุฌููุน ุงููุตูุต ููุถุนูุงูุง ูู list ูุฌุจ ุนูููุง ุงูุขู ุฃู ูุญูููุง ูุง ุดุฑุญูุง ูู ูุฐู  ุงูุฎุทูุฉ   
<a href="#ุดูู-ุงู-dataset"> ุดูู ุงู Dataset</a> ูููู ุชุญููููุง ูุชุฎุฒูููุง ูู ุงูุฐุงูุฑุฉ ููุฐุง ูู ูููู ุนููู ุญูุซ ุฃู ุนุฏุฏ ุงููููุงุช ุงูุซุฑ ูู 40M ูุฐูู ุณูุณุชุฎุฏู ุทุฑููุฉ (Sliding window) ุงู ุจุงูุนุฑุจูุฉ ุฅุฒุงุญุฉ ุงููุงูุฐุฉ   ููุณุชุฎุฏู  ุงูุถุง ุงู generators ููู ููุฒุฉ ุฑุงุฆุนุฉ ูู ุจุงูุซูู ุณุชุณุงุนุฏูุง ููุชุนุงูู ูุน ุชูู ุงูุจูุงูุงุช ุงููุจูุฑุฉุ ุฅุฐุง ูู ุชุณูุน ุนููุง ูู ูุจู ูุฌุจ ุฃู ุชุชุนูููุง ููู ุฌุฒุก ููู.
</p>

```python
def get_windows(words, c):
    i = c
    while i < len(words) - c:
        center_word = words[i]
        context_words = words[(i-c):i] + words[(i+1):(i+c+1)]
        yield center_word, context_words
        i += 1
```
<p dir='rtl'>
ูุซุงู
</p>

```python
gen = get_windows(['ุงุญุจ'  ,'ููุงุฏุฉ'  ,'ุงูุณูุงุฑุงุช'  ,'ู' ,'ุงุญุจ' ,'ููุงุฏุฉ'  ,'ุงูุฏุฑุงุฌุงุช'],1)
for center, context in gen :
    print(f'{center}\t{context}')
```

<p dir='rtl'>
ุงููุชูุฌุฉ
</p>

```python
ููุงุฏุฉ    ['ุงุญุจ', 'ุงูุณูุงุฑุงุช']
ุงูุณูุงุฑุงุช    ['ููุงุฏุฉ', 'ู']
ู    ['ุงูุณูุงุฑุงุช', 'ุงุญุจ']
ุงุญุจ    ['ู', 'ููุงุฏุฉ']
ููุงุฏุฉ    ['ุงุญุจ', 'ุงูุฏุฑุงุฌุงุช']
```

## ุชุญููู ุงููุตูุต ุงูู one-hot vector
{: .ara}
<p dir='rtl'>
ูููุจุฏุฃ ุจุชุฏุฑูุจ ุงู model ูุฌุจ ุชุญููู ุงูุตูุฑุฉ ูู ุงููุซุงู ุงูุณุงุจู ุฅูู ุฃุฑูุงู. ุณูุณุชุนูู ูู ูุฐุง ุทุฑููุฉ one-hot vectors
</p>

<p dir='rtl'>
ุงููุง ุงุณุชุฎุฑุงุฌ ุงููููุงุช ุจุฏูู ุชูุฑุงุฑ . ูุซุงู
</p>

```python
"ุฃุญุจ  ููุงุฏุฉ ุงูุณูุงุฑุงุช ู ุฃุญุจ  ููุงุฏุฉ ุงูุฏุฑุงุฌุงุช"
```

<p dir='rtl'>
ุงููููุงุช ุจุฏูู ุชูุฑุงุฑ
</p>


```python
ุฃุญุจ - ููุงุฏุฉ - ุงูุณูุงุฑุงุช - ู - ุงูุฏุฑุงุฌุงุช
```

<p dir='rtl'>
ุจุฏ ุชุญููููุง ุณุชูู ุจูุฐุง ุงูุดูู
</p>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/one_hot.png)

<p dir='rtl'>
ุฌูุฏ ุจุฏ ุญูููุง ุงููููุงุช ูู ุงููุตูุต ุงูู one-hot vectors ููู ุดูู ุงููุฏุฎูุงุช (Cotext words) ุงูุชู ุญูููุงูุง ุงูู ุงู model ููุชุนููุ ูููุชุฑุถ ุฃู ูุฏููุง ูุฐุง ุงููุฏุฎู
</p>

```python
['ุงุญุจ', 'ุงูุณูุงุฑุงุช']
```

<p dir='rtl'>
ูุชุญูููู ุงูู vector ูุงุญุฏ ููุท ุจุฏูุง ูู ุฃุฑุจุนุฉุ ุณูุฌุชูุน ููู ุงู vectors ุซู ููุณููุง ุนูู ุนุฏุฏูุงุ ูุชุตุจุญ ุจุฐูู ุงูุดูู
</p>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/average.png)

<p dir='rtl'>
ููุชุญููู ุงู (Center word) ูู ูุญุชุงุฌ ููุฐุง ุ ููู ูููุฉ ูุงุญุฏุฉ
</p>

<p dir='rtl'>
ูุซุงู : ุงู (center words) ุงููุซุงู ุจุงูุฃุนูู
</p>

```python
'ููุงุฏุฉ'
```

<p dir='rtl'>
ููููุฉ ุงููุชุฌู ุงูุฎุงุต ุจูุง ูู ุชุชุบูุฑ
</p>

![words line](/images/2020-10-14-Make-Your-Own-CBOW/center_words.png)



<p dir='rtl'>
ุงูุดูู ุงูููุงุฆู ูู Dataset
</p>

 
![words line](/images/2020-10-14-Make-Your-Own-CBOW/final_dataset.png)




## ุงููููู ุงูุจูุงุฆู ูู model ุงูุฎุงุต ุจุงู CBOW
{: .ara}



<p dir='rtl'>
ูุชููู ุงู model ุจุงุณุชุฎุฏุงู ูุง ูุนุฑู ุจุงู (Shallow neural networks) ุฃู ุงูุดุจูุงุช ุงูุชู ุชุชููู ูู ุนุฏุฏ ุตุบูุฑ ุฌุฏุง ูู ุงูุทุจูุงุช (layers)ุ
</p>

<p dir='rtl'>
ุณุชููู ููุง ุงูุดุจูุฉ ุงูุฎุงุตุฉ ุจุงู CBOW ูู ุซูุงุซุฉ ูุฑุงุญู (layers) ููุท. ุงููุฑุญูุฉ ุงูุงููู ุณุชููู ูููุฏุฎูุงุช (input layer)ุ ูุงููุฑุญูุฉ ุงูุซุงููุฉ ุฃู ุงูุฏุงุฎููุฉ (hidden layers)ุ ูุงููุฑุญูุฉ ุงูุซุงูุซุฉ ุงููุฎุฑุฌุงุช (output layer).
</p>


<p dir='rtl'>
ุนุฏุฏ ุงูุนุตุจููุงุช (node or neurons) ูู ุงููุฑุญูุฉ ุงูุงููู ูุงูุงุฎูุฑุฉ ุณูููู ูุชุณุงูู ุ ุญูุซ ุงููุง ุชุณุงูู ุนุฏุฏ ุงููููุงุช ุจุฏูู ุชูุฑุงุฑ ูู ุงูู (dataset)
</p>



<p dir='rtl'>
ุจุงููุณุจุฉ ูููุฑุญูุฉ ุงูุซุงููุฉ ุณูููู ุนุฏุฏ ุงูุนุตุจููุงุช ูููุง ุงุฎุชูุงุฑู ููุง ุดุฑุญูุง ุณุงุจูุงุ
</p>

<p dir='rtl'>
ุงูุฃุจุนุงุฏ ุงูุฎุงุตุฉ ุจูู ูุฑุญูุฉ
</p>


- Vocabulary size = V
- input layer = V*1
- output layer = V*1
- hidden layer = N*1

<p dir='rtl'>
ูู ุชูู ุงูุฃุจุนุงุฏ ูููู ุงุณุชูุชุงุฌ ุงูุฃุจุนุงุฏ ุงูุฎุงุตุฉ ุจุงู (weights) ูุชููู ูุงูุงุชู
</p>

- W1 = N*v
- b1 = N*1
- W2 = V*N
- b2 = V*1

![words line](/images/2020-10-14-Make-Your-Own-CBOW/network_shape.png)


<p dir='rtl'>
ูููู ุนูุฏ ุงุณุชุฎุฏุงู ุงูู batch inputs ุณุชุชุบูุฑ ุงูุงุจุนุงุฏ ููููุง ุ ูุชูุงุณุจ ุนุฏุฏ ุงู batches
</p>


- Vocabulary size = V
- Batch size = m
- input layer = V*m
- output layer = V*m
- hidden layer = N*m


<p dir='rtl'>
ููุง ูู ูุชุบูุฑ ุงูุงุจุนุฏ ุงูุฎุงุตุฉ ุจ (W1 , W2)
</p>


- b2 = V*m
- b2 = V*m

![words line](/images/2020-10-14-Make-Your-Own-CBOW/batch_shape.png)

## ุนูููุฉ ุงูุชุนูู
{: .ara}


<p dir='rtl'>
ุชููุณู ุนูููุฉ ุงูุชุนูู ุฅูู ุซูุงุซ
</p>

- 1- Forward Propagation
<p dir='rtl'>
ูููุง ูุชู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุฎูุงู ุงูุดุจูุฉ ูุงูุชูุจุค ุจุงููุชุงุฆุฌ
</p>

<p dir='rtl'>
ูู ุฃูู ุงูุฃูุฑ ูุณุชุฎุฏู ููู ุนุดูุงุฆุฉ ู (W1, W2)
</p>


```python
def initialize_model(N,V, random_seed=1):

    np.random.seed(random_seed)

    # W1 has shape (N,V)
    W1 = np.random.rand(N,V)
    # W2 has shape (V,N)
    W2 = np.random.rand(V,N)
    # b1 has shape (N,1)
    b1 = np.random.rand(N,1)
    # b2 has shape (V,1)
    b2 = np.random.rand(V,1)

    return W1, W2, b1, b2
```

```python
def forward_prop(x, W1, W2, b1, b2):

    # Calculate h
    h = np.dot(W1,x)+b1
    # Apply the relu on h (store result in h)
    h = np.maximum(0,h)    
    # Calculate z
    z = np.dot(W2,h)+b2

    return z, h
```

- 2- Cost

<p dir='rtl'>
ูุญุณุจ ุงู (cost) ุงู ุซูู ุงูุฃุฎุทุงุก ุงููุงุชุฌุฉ ูู ุงู (forward propagation) ุ ูุงููุฏู ูู ุนูููุฉ ุงูุชุฏุฑูุจ ูู ุชูููู ูุฐู ุงูุงุฎุทุงุก ูุฏุฑ ุงูุงููุงู
</p>

```python
def compute_cost(y, yhat, batch_size):
    logprobs = np.multiply(np.log(yhat),y) + np.multiply(np.log(1 - yhat), 1 - y)
    cost = - 1/batch_size * np.sum(logprobs)
    cost = np.squeeze(cost)
    return cost
```

- Backpropagation and gradient descent

<p dir='rtl'>
ููุฐู ุงููุฑุญูุฉ ูุณุชุฎุฏู ุงูู (Gradient descent) ุ ูุชุนุฏูู ููู ุงู (weights) ูุชูููู ูุณุจุฉ ุงูุฎุทุฃ
</p>

<p dir='rtl'>
ุงู ููุช ูู ุชุณูุน ุนู (Gradient descent) ูุฃูุตุญ ุจูุฑุงุกุฉ ูุฐุฉ  
<a href="https://aliabdelaal.github.io/blog/gradient-descent-family/"> ุงูููุงูุฉ</a>
</p>

```python
def back_prop(x, yhat, y, h, W1, W2, b1, b2, batch_size):

    # Re-use it whenever you see W2^T (Yhat - Y) used to compute a gradient
    l1 = np.dot(W2.T,(yhat-y))
    # Apply relu to l1
    l1 = np.maximum(0,l1)
    # Compute the gradient of W1
    grad_W1 = (1/batch_size)*np.dot(l1,x.T)    
    # Compute the gradient of W2
    grad_W2 = (1/batch_size)*np.dot(yhat-y,h.T)
    # Compute the gradient of b1
    grad_b1 = np.sum((1/batch_size)*np.dot(l1,x.T),axis=1,keepdims=True)
    # Compute the gradient of b2
    grad_b2 = np.sum((1/batch_size)*np.dot(yhat-y,h.T),axis=1,keepdims=True)
    
    return grad_W1, grad_W2, grad_b1, grad_b2
```

<p dir='rtl'>
ููููู ุชูุฎูุต ูุฐู ุงูุนูููุฉ ูู ุฎูุงู ุงูุตูุฑุฉ ุจุงูุงุณูู
</p>


![words line](/images/2020-10-14-Make-Your-Own-CBOW/train_process.png)

<p dir='rtl'>
ุงูุงู ุจุนุฏ ุงู ุงูุชูููุง ูู ุงูููุงููู ุงูุงุณุงุณูุฉ ุงููุงุฒูุฉ ููุชุทุจูู ุ ูููุงูุด ุงูุขู ุจุนุถ ุงููุชุบูุฑุงุช ุงูุชู ุณูุชููู ุนูููุง ูุชุงุฆุฌ ุงูููุฏูู
</p>

- ูก- ุนุฏุฏ ูููุงุช ุงู (Context words)
{: .ara}

<p dir='rtl'>
ุนู ุชุบูุฑ ูุฐุง ุงููุนุงูู ุณุชุชุบูุฑ ุงูููุงุกุฉ ุงูููุงุฆูุฉ ุ ุณูุณุชุฎุฏู ููุง  ูููุฉ ุงููุนุงูู ุจ 2 (C)
</p>

- ูข- ุงุจุนุงุฏ ุงู (word embeddings)
{: .ara}

<p dir='rtl'>
ุณุชุณุชุฎุฏู ููุง ูุชุฌู  ุจุดูู (300*1)
</p>

- ูฃ- ูุนุงูู ุงูุชุนูู
{: .ara}

<p dir='rtl'>
ุณูุณุชุฎุฏู ููุง ูุนุงูู ูููุชู .03 ูุณููู ุจููุฏุงุฑ .66 ูู ูู ููุฉ ุ
</p>

- ูค- ุนุฏุฏ ุงูููุงุช
{: .ara}

<p dir='rtl'>
ุณูุณุชุฎุฏู ููุง ุนุฏูุฏ ุงูููุงุช ุจ 20
</p>

```python
def gradient_descent(data, word2Ind, N, V, num_iters, C=2, batch_size=128, alpha=0.03):

    W1, W2, b1, b2 = initialize_model(N,V, random_seed=282)
    batch_size = batch_size
    iters = 0
    C = C
    for x, y in get_batches(data, word2Ind, V, C, batch_size):

        # Get z and h
        z, h = forward_prop(x, W1, W2, b1, b2)
        # Get yhat
        yhat = softmax(z)
        # Get cost
        cost = compute_cost(y, yhat, batch_size)
        if ( (iters+1) % 2 == 0):
            print(f"iters: {iters + 1} cost: {cost:.6f}")
   
        # Get gradients
        grad_W1, grad_W2, grad_b1, grad_b2 = back_prop(x, yhat, y, h, W1, W2, b1, b2, batch_size)
        
        # Update weights and biases
        W1 -= alpha*grad_W1
        W2 -= alpha*grad_W2
        b1 -= alpha*grad_b1
        b2 -= alpha*grad_b2
        
        iters += 1
        if iters == num_iters:
            break
        if iters % 100 == 0:
            alpha *= 0.66
            
    return W1, W2, b1, b2
```

```python
C = 2
batch_size = 128

# getdict is o=holding the words and its index
word2Ind = get_dict(data)
V = len(word2Ind)
num_iters = 20

print("Call gradient_descent")
W1, W2, b1, b2 = gradient_descent(data, word2Ind, N, V, num_iters, C, batch_size)
```

<p dir='rtl'>
ุงููุชูุฌุฉ
</p>

```python
Call gradient_descent
iters: 2 cost: 14.706067
iters: 4 cost: 0.004671
iters: 6 cost: 0.004275
iters: 8 cost: 0.003942
iters: 10 cost: 0.003657
iters: 12 cost: 0.003411
iters: 14 cost: 0.003196
iters: 16 cost: 0.003007
iters: 18 cost: 0.002839
iters: 20 cost: 0.002689
```
<p dir='rtl'>
ุฌููุน ุงูุงููุงุฏ ุงููุณุชุฎุฏูุฉ ุณุชุฌุฏูุง

<a href='https://github.com/AmienKhaled/CBOW-For-Arabic-Language'>
ููุง
</a>

 ุนูู ุญุณุงุจู ุงูุฎุงุต ุนูู github
</p>


## ุงุณุชุฎุฑุงุฌ ุงู Word Embeddings
{: .ara}

<p dir='rtl'>
ููุฌุฏ ุซูุงุซ ุงุฎุชูุงุฑุงุช ูููููุง ุจููุง ุงุณุชุฎุฑุงุฌ ุงู word embeddings
</p>


- ูก- ูู ุฎูุงู W1
{: .ara}


- ูข- ูู ุฎูุงู W2
{: .ara}


- ูฃ- ูู ุฎูุงู ูุชูุณุท ุงูููู ุจูู (W1 , W2)
{: .ara}


## ุชูููู ููุงุกุฉ ุงู word embeddings
{: .ara}



- 1- Intrinsic Evaluation

<p dir='rtl'>
ูููุณู ุงูู ูุณููู
</p>

- 1- Analogies
<p dir='rtl'>
ูููุณู ุงูู ุนุฏุฉ ุงููุงุนุ ุชุนุชูุฏ ุฌููุนูุง ุนูู ุงููุนูู ุงููููุงุช
</p>

- a- Semantic analogies
<p dir='rtl'>
ููุนุชูุฏ ุนูู ุงูููุงุฑูุงุช ุงูุฏูุงููุฉ ุจูู ุงูุฃููุงุธ ุ ูุซุงู
</p>

```python
 ุนูุงูุฉ "ุจุงุฑูุณ" ุจุงููุณุจุฉ "ููุฑูุณุง" ุ ูุซู ุนูุงูุฉ "ุงููุงูุฑุฉ" ุจุงููุณุจุฉ __ุ___
```

- b- Syntactic analogies
```python
ุนูุงูุฉ ูููุฉ "ููุนุจ" ุจุงููุณุจุฉ ููููุฉ "ูุนุจ" ุูุซู ุงูุนูุงูุฉ ุจูู ูููุฉ "ูุดุงูุฏ" ููููุฉ __ุ__
```

- 2- Clustering
<p dir='rtl'>
ูุณุชุฎุฏู ูููุง ุฎูุงุฑุฒููุฉ ุงูุชุฌููุน (clustering)ุ ููุชุฎุชุจุฑ ูุฏู ุชุฌุงูุณ ุงููููุงุช
</p>

- 2- Visualization
<p dir='rtl'>
ูุณุชุฎุฏู ููุง ุงูุงุฏูุงุช ุงููุฎุชููุฉ ูุตูุงุนุฉ ูุฎุฑุฌุงุช ูุฑุฆูุฉ ููููุง ูู ุฎูุงููุง ุงุณุชูุชุงุฌ ููุงุกุฉ ุงู model
</p>


- 2- Extrinsic Evaluation

<p dir='rtl'>
ุชุนุชูุฏ ููุง ุนูู ุงุณุชุฎุฏุงู ุงู (word embeddings) ูู ุชุทุจููุงุช ุงุฎุฑู ูู ุนูููุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉ ูุซู (NER, Sentiment analysis)
</p>

<p dir='rtl'>
ูููู ุชูู ุงูุทุฑููุฉ ุจูุง ุจุนุถ ุงูุนููุจ ููู ุงุณุชููุงู ุงููุซูุฑ ูู ุงูููุชุ ูุนูุฏ ุญุฏูุซ ุฃุฎุทุงุก ูู ุชุณุชุทูุน ุชุญุฏูุฏ ููุงู ุงูุฎุทุฃ ุ  ูู ูู ูู ุงูุฎูุงุฑุฒููุฉ ุงู ูู ุงู word embeddings
</p>


## ุชุญุฏูุฏ ููุงุกุฉ ุงู model ุงููุณุชุฎุฏู ูู ูุฐุง ุงูููุงู
{: .ara}

<p dir='rtl'>
ูู ูุฐุง ุงูููุงู ููุง ุฐูุฑุช ุณุงููุง ุููุฏ ุทุจูุช ุทุฑููุฉ ุงู CBOW ุนูู ุงููุบุฉ ุงูุนุฑุจูุฉ ุูููุฏ ุชุฑุชู ุฑุงุจุท ููุงููุงุฏ ุงููุณุชุฎุฏูุฉ ููุง ูุชุณุงุนุฏู ูู ุชุฏุฑูุจ ุงูmodel ุงูุฎุงุต ุจู ุ
</p>


<p dir='rtl'>
ูุณููุงูุด ุงูุงู ุงูููุงุกุฉ ุงูุฎุงุตุฉ ุจุฐูู ุงูููุฏูู ูู ุฎูุงู ุงู Visulization ู ุงู Analogies
</p>

- 1- Visulization

<p dir='rtl'>
ุณูุฎุชุงุฑ ุนุฏุฏ ูููุงุช ููุฑุณููุง ุนูู ูุญูุฑูู ุ ููู ููุงู ูุดููุฉ ููู ุงู ุงุนุจุนุงุฏ ุงู word embeddings ุงููุณุชุฎุฏูุฉ 300 ุูุฐูู ุณูุณุชุฎุฏู ุชูููุฉ ุงู PCA ูุชุญููู ุงูุงุจุนุงุฏ ุงู 300 ูุจุนุฏูู ููุท
</p>

```python
ุงููููุงุช ุงููุณุชุฎุฏูุฉ :
['ููู','ูููู','ุฑุฌู','ุงูุฑุงู','ุทูู','ุทููู','ุญุฑุจ','ุณูุงู','ุงูุงุฑุถ','ุงูุณูุงุก','ุงูููุงูุจ','ุงููุฌูู','ุงูููุฑ',]
```

![words line](/images/2020-10-14-Make-Your-Own-CBOW/words_analogies.png)

<div dir='rtl' class='notice--success'>
ูุฌุฏ ููุงุงู ุงููููุงุช ุงูุชู ุชุฑุจุทููุง ุนูุงู ูููุฉ ุงููุณุงูุฉ ุจูููู ูุฑูุจุฉ ุ ูุซู (ุทูู -ุทููุฉ) ุ (ุญุฑุจ- ุณูุงู)ุ (ุฑุฌู - ุงูุฑุงู)ุ (ููู - ูููุฉ)
</div>

<div dir='rtl' class='notice--success'>
ููุฌุฏ ุงูุถุง ุงู ุงููููุงุช ุงูุฎุงุตุฉ ุจุนูู ุงูููู ูุฑูุจุฉ ูู ุจุนุถูุง ูุซูุง (ุงูุงุฑุถ - ุงููุฌูู - ุงูููุฑ -ุงูููุงูุจ)
</div>

<div dir='rtl' class='notice--success'>
ูููุง ูุชูุชุฌ ุงูู ุงุณุชุทุงุน ุงู ูุฌุฏ ุงูุนูุงูุงุช ุจูู ุงููููุงุช ุ ูููู ูุฐุง ุงู model ูุญุชุงุฌ ุงูู ูุฒูุฏ ูู ุงููุตูุต ููุณุชุทูุน ุงู ูุบุทู ูุนุธู ูููุงุช ุงููุบุฉ ุ ููุณุชุฎุฑุฌ ูุนุงูู ุงูุซุฑ ููู ูููุฉ
</div>


<div dir='rtl' class='notice--success'>
ูู ุงูููุงูุฉ ุงุชููู ุงู ููุงู ุงูููุงู ุงุนุฌุงุจูู ุ ููุฏ ุญุงููุช ุงูุชูููู ุจูู ุงููุบุฉ ุงูุนุฑุจูุฉ ูุงููุตุทูุญุงุช ุงูุนูููุฉ ูุฏุฑ ุงูุฅููุงู ุ ูู ุญุงูุฉ ูุฌูุฏ ุงูุชุฑุงุญุงุช ุงู ุฎุทุฃ ูู ุงูููุงู ุณูุงุก ูุงู ุฅููุงุฆู ุฃู ุบูุฑู ุ ุจุฑุฌุงุก ูุฑุงุณูุชู.
</div>


<div dir='rtl' class='notice--success'>
ุงูููู ุนูููุง ูุงูููุนูุง ูุงููุนูุง ุจูุง ุนููุชูุง ุงูู ุงูุช ุงูุนููู ุงูุญููู
</div>



## ุงููุตุงุฏุฑ
{: .ara}


<div dir='rtl'>

<ul>
<li><a href='https://www.coursera.org/learn/probabilistic-models-in-nlp'>
ููุฑุณ ููุชุนูู
</a></li>
<li><a href='https://arxiv.org/pdf/1301.3781v3.pdf'>
ุงููุฑูุฉ ุงูุจุญุซูุฉ ูู CBOW
</a></li>

<li><a href='https://aliabdelaal.github.io/blog/gradient-descent-family/'>
Gradient Descent
</a></li>


<li>
<a href='https://github.com/AmienKhaled/CBOW-For-Arabic-Language'>
ุฌููุน ุงูุงููุงุฏ ุงููุณุชุฎุฏูุฉ
</a>
</li>

</ul>









